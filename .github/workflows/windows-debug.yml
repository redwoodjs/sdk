name: Windows Debug Session

on:
  workflow_dispatch:
    inputs:
      cursorTunnelName:
        description: "Optional Cursor tunnel name (<=20 chars); leave blank for random"
        required: false

jobs:
  debug-session:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4

      - name: Download Cursor CLI (bash)
        shell: bash
        run: |
          set -euo pipefail
          mkdir -p "$GITHUB_WORKSPACE/.tmp/cursor_cli"
          curl -Lk "https://api2.cursor.sh/updates/download-latest?os=cli-win32-x64" -o "$GITHUB_WORKSPACE/.tmp/cursor_cli/cursor_cli.tar.gz"

      - name: Extract Cursor CLI
        shell: pwsh
        run: |
          $CursorDir = "$env:GITHUB_WORKSPACE\.tmp\cursor_cli"
          $CursorArchive = "$CursorDir\cursor_cli.tar.gz"
          tar -xvf $CursorArchive -C $CursorDir | Out-Null
          Write-Host "Cursor CLI extracted to $CursorDir"

      - name: Start Interactive Debug Session
        uses: mxschmitt/action-tmate@v3
