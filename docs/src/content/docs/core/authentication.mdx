---
title: Authentication
description: Secure your application with sessions and passwordless login.
---
import { Aside } from "@astrojs/starlight/components";

RedwoodSDK enables secure, passwordless authentication using **passkeys ([WebAuthn](https://webauthn.guide/))** via a bundled addon.

## The Bundled Addon Approach

Instead of providing a rigid, black-box authentication API, RedwoodSDK ships the complete source code for a passkey implementation as a **bundled addon**. This addon lives inside the `rwsdk` package and is versioned along with it.

When you want to add authentication, you copy the addon's source code directly into your own project. This gives you:
- **Full Ownership:** The code is yours. You can inspect it, modify it, and extend it to fit your exact needs.
- **Guaranteed Compatibility:** The addon code is always compatible with the version of the SDK you have installed.
- **Transparency:** You can see exactly how the authentication is implemented, with no hidden magic.

## Applying the Passkey Addon

The instructions for copying and configuring the passkey addon are included in the `README.md` file within the addon itself.

To view the instructions, run the following command in your project's root directory:

```bash showLineNumbers=false
npx rw-scripts addon passkey
```

This command will print the step-by-step guide to your console. Follow the guide to get passkey authentication running in your application. The process will involve:
1. Copying the addon's source files into your project's `src` directory.
2. Updating your `wrangler.jsonc` file with the required D1 database and Durable Object bindings.
3. Updating your `package.json` with required dependencies.
4. Setting the necessary environment variables for session secrets and WebAuthn configuration.

## How it Works

Once applied, the addon provides a complete passkey system that uses **[Cloudflare Durable Objects](https://developers.cloudflare.com/durable-objects/)** for session persistence and **[Cloudflare D1](https://developers.cloudflare.com/d1/)** for the database layer.

### Session Management
Sessions are handled using a combination of secure, signed cookies for session IDs and Durable Objects for storing session data. When a request is made, middleware verifies the `session_id` cookie, retrieves the session data from the corresponding Durable Object, and fetches the user from the D1 database.

Using a single Durable Object per session ensures data consistency and simplifies session revocation. Active sessions are kept in memory, which reduces database lookups.

### Passkey Authentication (WebAuthn)
The login and registration processes follow the standard WebAuthn ceremony.
1. The client requests a challenge from the server.
2. The server generates a challenge and stores it in the session Durable Object.
3. The browser's WebAuthn API prompts the user to use their passkey (e.g., via Face ID, Touch ID, or a hardware key) to sign the challenge.
4. The signed challenge is sent back to the server.
5. The server verifies the signature. If it is valid, the user's ID is associated with the session, completing the login.
