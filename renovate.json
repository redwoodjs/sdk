{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:recommended"],
  "separateMajorMinor": false,
  "customManagers": [
    {
      "customType": "regex",
      "fileMatch": [
        "^starter/package\\.json$",
        "^playground/.*/package\\.json$",
        "^addons/.*/package\\.json$"
      ],
      "matchStrings": [
        "\"(?<depName>react|react-dom|react-server-dom-webpack)\":\\s*\"(?<currentValue>\\d+\\.\\d+\\.\\d+-canary-[a-f0-9]+-\\d{8})\""
      ],
      "extractVersion": "^(?<version>\\d+\\.\\d+\\.\\d+-canary)-[a-f0-9]+-(?<date>\\d{8})$",
      "extractVersionTemplate": "{{version}}-{{date}}",
      "datasourceTemplate": "npm",
      "versioningTemplate": "npm",
      "depTypeTemplate": "dependencies"
    }
  ],
  "packageRules": [
    {
      "description": "Group infrastructure dependencies (Actions, Docker, Node.js, pnpm).",
      "matchManagers": ["github-actions", "dockerfile", "nodenv"],
      "groupName": "docs-and-infra-deps",
      "schedule": ["on sunday"]
    },
    {
      "description": "Group pnpm version from root package.json with other infra deps",
      "matchFileNames": ["package.json"],
      "matchPackageNames": ["pnpm"],
      "groupName": "docs-and-infra-deps",
      "schedule": ["on sunday"]
    },
    {
      "description": "Group all SDK internal dependencies into a single weekly PR.",
      "matchFileNames": ["sdk/package.json"],
      "excludePackageNames": ["vite"],
      "groupName": "sdk-internal-deps",
      "schedule": ["on sunday"]
    },
    {
      "description": "Group all starter application dependencies into a single weekly PR.",
      "matchFileNames": ["starter/package.json"],
      "excludePackageNames": [
        "@cloudflare/vite-plugin",
        "@cloudflare/workers-types",
        "wrangler",
        "vite",
        "react",
        "react-dom",
        "react-server-dom-webpack"
      ],
      "groupName": "starter-deps",
      "schedule": ["on sunday"]
    },
    {
      "description": "Update non-React SDK peer dependencies in starter, playground, and addon projects as soon as they are available.",
      "matchFileNames": [
        "starter/package.json",
        "playground/**/package.json",
        "addons/**/package.json"
      ],
      "matchPackageNames": [
        "@cloudflare/vite-plugin",
        "@cloudflare/workers-types",
        "wrangler",
        "vite"
      ],
      "updateTypes": ["major", "minor", "patch"],
      "groupName": "starter-peer-deps",
      "prPriority": 1
    },
    {
      "description": "Group the SDK's vite dev dependency with starter peer deps to keep them in sync.",
      "matchFileNames": ["sdk/package.json"],
      "matchPackageNames": ["vite"],
      "matchDepTypes": ["devDependencies"],
      "groupName": "starter-peer-deps",
      "prPriority": 1
    },
    {
      "description": "Ignore non-React peerDependencies in the SDK to maintain a wide compatibility range.",
      "matchFileNames": ["sdk/package.json"],
      "matchPackageNames": [
        "@cloudflare/vite-plugin",
        "@cloudflare/workers-types",
        "wrangler",
        "vite"
      ],
      "matchDepTypes": ["peerDependencies"],
      "enabled": false
    },
    {
      "description": "Update React dependencies in starter, playground, and addon projects, tracking the 'next' tag.",
      "matchFileNames": [
        "starter/package.json",
        "playground/**/package.json",
        "addons/**/package.json"
      ],
      "matchPackageNames": ["react", "react-dom", "react-server-dom-webpack"],
      "followTag": "next",
      "ignoreUnstable": false,
      "groupName": "starter-peer-deps",
      "prPriority": 1
    },
    {
      "description": "Group dependencies for the docs site.",
      "matchFileNames": ["docs/package.json"],
      "groupName": "docs-and-infra-deps",
      "schedule": ["on sunday"]
    },
    {
      "description": "Group dependencies from the root package.json.",
      "matchFileNames": ["package.json"],
      "excludePackageNames": ["pnpm"],
      "groupName": "docs-and-infra-deps",
      "schedule": ["on sunday"]
    },
    {
      "description": "Group playground and addon non-peer dependencies with other infrastructure dependencies.",
      "matchFileNames": [
        "playground/**/package.json",
        "addons/**/package.json"
      ],
      "excludePackageNames": [
        "@cloudflare/vite-plugin",
        "@cloudflare/workers-types",
        "wrangler",
        "vite",
        "react",
        "react-dom",
        "react-server-dom-webpack"
      ],
      "groupName": "docs-and-infra-deps",
      "schedule": ["on sunday"]
    }
  ],
  "prHeader": " chore(deps): {{{prTitle}}}",
  "prBodyNotes": "This PR updates the following dependencies:\n\n{{{table}}}",
  "automerge": false,
  "major": { "automerge": false },
  "minor": { "automerge": false },
  "patch": { "automerge": false }
}
